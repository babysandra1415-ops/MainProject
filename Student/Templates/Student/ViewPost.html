<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>View Posts</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        .like-btn {
            cursor: pointer;
            font-size: 24px; 
            transition: transform 0.2s;
        }
        .like-btn:hover {
            transform: scale(1.3);
        }
    </style>
</head>
<body>

<table align="center" width="40%" cellpadding="6">
    {% for i in post %}

    <tr>
        <td width="15%" align="center">
            {% if i.faculty and i.faculty.faculty_photo %}
                <img src="{{ i.faculty.faculty_photo.url }}" width="50" height="50">
            {% elif i.student and i.student.student_photo %}
                <img src="{{ i.student.student_photo.url }}" width="50" height="50">
            {% elif i.college and i.college.college_logo %}
                <img src="{{ i.college.college_logo.url }}" width="50" height="50">
            {% endif %}
        </td>
        <td width="85%">
            <b>
                {% if i.faculty %}
                    {{ i.faculty.faculty_name }}
                {% elif i.student %}
                    {{ i.student.student_name }}
                {% elif i.college %}
                    {{ i.college.college_name }}
                {% endif %}
            </b>
        </td>
    </tr>

    <tr>
        <td colspan="2" align="center">
            <img src="{{ i.post_photo.url }}" width="100%">
        </td>
    </tr>

    <tr>
        <td colspan="2">
            <span class="like-btn" data-post="{{ i.id }}">
                {% if i.id in liked_posts %}
                    ‚ù§Ô∏è
                {% else %}
                    ü§ç
                {% endif %}
            </span>
            &nbsp;
            <a href="{% url 'Student:Comment' i.id %}">Comment</a>
        </td>
    </tr>

    <tr>
        <td colspan="2">{{ i.post_description }}</td>
    </tr>

    <tr>
        <td colspan="2"><hr></td>
    </tr>

    {% endfor %}
</table>

<script>
$(document).ready(function(){
    $('.like-btn').click(function(){
        var heart = $(this);
        var post_id = heart.data('post');

        $.ajax({
            url: "{% url 'Student:likepost' %}",
            type: "POST",
            data: {
                'post_id': post_id,
                'csrfmiddlewaretoken': '{{ csrf_token }}'
            },
            success: function(response){
                if(response.liked){
                    heart.text('‚ù§Ô∏è'); 
                } else {
                    heart.text('ü§ç');
                }
            },
            error: function(){
                alert('Something went wrong!');
            }
        });
    });
});
</script>

</body>
</html>
